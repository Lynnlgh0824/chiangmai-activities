# 🚀 快速同步指南 - 飞书表格到项目

> ⚡ 一键将Excel/CSV数据转换为JSON格式

---

## ✅ 已准备就绪！

依赖库已安装：
- ✅ pandas 3.0.0
- ✅ openpyxl 3.1.5
- ✅ excel-to-json.py 脚本已就绪

---

## 📝 使用步骤（3步完成）

### 步骤1：在飞书表格中录入数据

访问您的多维表格：
https://my.feishu.cn/base/Tm8CbHiQUah6SSs5oL9cJ4qYnvd

按照以下字段录入活动：

**必填字段：**
- 序号
- 活动类型（固定频率/临时活动）
- 活动标题
- 分类
- 活动描述
- 星期/日期
- 时间
- 地点名称

**可选字段：**
- 状态、持续时间、详细地址、价格显示
- 最低价格、最高价格、最大人数
- 灵活时间、需要预约、图片URL、来源链接

### 步骤2：下载Excel文件

1. 在飞书多维表格中，点击右上角 **"..."** 菜单
2. 选择 **"下载为"** → **"Excel"** （或CSV）
3. 保存文件到项目根目录：
   - `清迈活动数据.xlsx` 或
   - `活动数据.csv`

### 步骤3：运行转换脚本

```bash
# 进入项目目录
cd /Users/yuzhoudeshengyin/Documents/my_project/Chiengmai

# 运行转换（指定文件名）
python3 excel-to-json.py 清迈活动数据.xlsx

# 或输出到指定文件
python3 excel-to-json.py 清迈活动数据.xlsx data/items.json
```

**脚本会自动：**
- 📊 读取Excel文件（支持.xlsx和.xls）
- 📝 转换为JSON格式
- 💾 保存到 `data/items.json`
- ✅ 显示转换进度

---

## 🎉 查看结果

刷新前端页面：
**http://localhost:5173**

所有活动数据应该已经更新！

---

## 📋 完整示例

```bash
# 1. 从飞书下载Excel文件到项目目录
#    文件名：清迈活动数据.xlsx

# 2. 运行转换脚本
python3 excel-to-json.py 清迈活动数据.xlsx

# 输出示例：
# ============================================================
# 🔄 飞书数据 → JSON 转换工具（支持Excel和CSV）
# ============================================================
# 📥 输入文件: 清迈活动数据.xlsx
# 📤 输出文件: data/items.json
# ============================================================
#
# 📊 Excel文件包含 3 个工作表:
#    1. 活动汇总
#    2. 固定频率活动
#    3. 临时活动
# ✅ 第 2 行：流瑜伽基础班
# ✅ 第 3 行：冥想课程
# ✅ 第 4 行：泰式烹饪工作坊
#
# ============================================================
# ✅ 转换完成!
# 📊 共处理 3 条记录
# 📁 输出文件: data/items.json
# ============================================================
#
# 💡 提示：
#    1. 请刷新前端页面查看更新
#    2. 前端地址: http://localhost:5173
#    3. 如果数据未更新，请重启服务器
```

---

## 🔧 支持的文件格式

| 格式 | 扩展名 | 说明 |
|------|--------|------|
| Excel | `.xlsx`, `.xls` | 推荐，自动读取第一个工作表 |
| CSV | `.csv` | UTF-8编码 |

---

## ⚡ 日常更新流程

每次修改飞书表格后：

```bash
# 1. 下载更新的Excel文件（覆盖旧文件）

# 2. 运行转换
python3 excel-to-json.py 清迈活动数据.xlsx

# 3. 刷新前端页面查看更新
```

就这么简单！🎉

---

## 💡 常见问题

### Q1: 脚本报错"缺少依赖库"？

**A:** 运行以下命令安装依赖：
```bash
pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple pandas openpyxl
```

### Q2: Excel文件有多个工作表，如何选择？

**A:** 脚本默认读取第一个工作表。如需使用其他工作表，可以：
1. 在Excel中删除不需要的工作表
2. 或导出单个工作表为CSV格式

### Q3: 转换后数据不显示？

**A:** 检查：
1. items.json 文件是否正确生成
2. 服务器是否正常运行（http://localhost:3000）
3. 浏览器是否需要强制刷新（Ctrl+Shift+R 或 Cmd+Shift+R）

### Q4: 如何保留手动添加的数据？

**A:** 目前脚本会覆盖整个items.json文件。如需保留手动数据，建议：
1. 在飞书表格中录入所有数据
2. 或修改脚本支持数据合并

---

## 📁 相关文件

- **[excel-to-json.py](excel-to-json.py)** - Excel转换脚本
- **[csv-to-json.py](csv-to-json.py)** - CSV转换脚本（备用）
- **[飞书个人版集成指南.md](飞书个人版集成指南.md)** - 详细使用说明
- **[活动录入表格-使用说明.md](活动录入表格-使用说明.md)** - 表格填写说明

---

## 🎯 下一步

1. ✅ 从飞书下载 `清迈活动数据.xlsx`
2. ✅ 运行 `python3 excel-to-json.py 清迈活动数据.xlsx`
3. ✅ 刷新前端页面查看结果
4. ✅ 开始添加活动数据！

---

**最后更新**：2025-01-25
**版本**：1.0（支持Excel和CSV）
