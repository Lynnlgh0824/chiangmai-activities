# 活动录入表格-改进版 使用说明

> 📁 文件名：活动录入表格-改进版.xlsx
> 📅 创建日期：2025-01-25
> ✨ 版本：2.0（改进版）
> 🎯 目标：模拟后台界面的活动类型选择体验

---

## 🎯 设计理念

本Excel表格**完全模拟** `http://localhost:3000/admin.html` 后台界面的活动录入体验：

### 后台界面 vs Excel表格

| 后台界面 | Excel表格 |
|---------|-----------|
| Tab切换选择活动类型 | 工作表切换选择活动类型 |
| 📅 固定频率活动 Tab | "固定频率活动" 工作表（绿色） |
| 📝 临时活动 Tab | "临时活动" 工作表（黄色） |
| 只显示相关字段 | 只包含相关字段 |
| 下拉选择 | 下拉选择（数据验证） |

---

## 📊 文件结构

### 3个工作表

#### 1️⃣ 活动汇总（首页）
- 📍 **颜色**：蓝色
- 🎯 **用途**：导航和说明中心
- 📝 **内容**：
  - 活动类型选择说明
  - 使用指引
  - 工作表切换提示

#### 2️⃣ 固定频率活动
- 📍 **颜色**：绿色表头
- 🎯 **用途**：录入每周重复的课程
- 📝 **字段**：
  - 包含"星期"字段（F列）
  - 包含"时间"字段（G列）
  - 不包含"具体日期"字段

#### 3️⃣ 临时活动
- 📍 **颜色**：黄色表头
- 🎯 **用途**：录入一次性活动
- 📝 **字段**：
  - 包含"具体日期"字段（F列）
  - 包含"时间"字段（G列）
  - 不包含"星期"字段

---

## 📋 字段对比

### 固定频率活动表（18个字段）

| 列 | 字段名称 | 必填 | 说明 | 示例 |
|---|---------|------|------|------|
| A | 序号 | - | 自动编号 | 1, 2, 3... |
| B | 活动标题 | ✅ | 课程名称 | 流瑜伽基础班 |
| C | 分类 | ✅ | 下拉选择 | 瑜伽 |
| D | 状态 | ❌ | 下拉选择 | 草稿/待开始/进行中/已过期 |
| E | 活动描述 | ✅ | 详细说明 | 适合初学者 |
| **F** | **星期** | ✅ | **周几上课** | **周一,周三,周五** |
| **G** | **时间** | ✅ | **上课时间** | **09:00-10:30** |
| H | 持续时间 | ❌ | 时长 | 1.5小时 |
| I | 地点名称 | ✅ | 地点 | 宁曼一号瑜伽馆 |
| J | 详细地址 | ❌ | 地址 | 清迈宁曼路1号 |
| K | 价格显示 | ❌ | 展示价格 | 免费、500฿ |
| L | 最低价格 | ❌ | 数字 | 0 |
| M | 最高价格 | ❌ | 数字 | 0 |
| N | 最大人数 | ❌ | 数字 | 15 |
| O | 灵活时间 | ❌ | 下拉是/否 | 否 |
| P | 需要预约 | ❌ | 下拉是/否 | 是 |
| Q | 图片URL | ❌ | 多个URL用Alt+Enter换行 | https://... |
| R | 来源链接 | ❌ | URL | https://... |

### 临时活动表（18个字段）

| 列 | 字段名称 | 必填 | 说明 | 示例 |
|---|---------|------|------|------|
| A | 序号 | - | 自动编号 | 1, 2, 3... |
| B | 活动标题 | ✅ | 活动名称 | 泰式烹饪工作坊 |
| C | 分类 | ✅ | 下拉选择 | 美食体验 |
| D | 状态 | ❌ | 下拉选择 | 草稿/待开始/进行中/已过期 |
| E | 活动描述 | ✅ | 详细说明 | 学习制作冬阴功汤 |
| **F** | **具体日期** | ✅ | **哪一天** | **2025-02-01** |
| **G** | **时间** | ✅ | **活动时间** | **14:00-17:00** |
| H | 持续时间 | ❌ | 时长 | 3小时 |
| I | 地点名称 | ✅ | 地点 | 清迈烹饪学校 |
| J | 详细地址 | ❌ | 地址 | 老城中心Ratchadamnoen路 |
| K | 价格显示 | ❌ | 展示价格 | 500฿ |
| L | 最低价格 | ❌ | 数字 | 500 |
| M | 最高价格 | ❌ | 数字 | 500 |
| N | 最大人数 | ❌ | 数字 | 10 |
| O | 灵活时间 | ❌ | 下拉是/否 | 否 |
| P | 需要预约 | ❌ | 下拉是/否 | 是 |
| Q | 图片URL | ❌ | 多个URL用Alt+Enter换行 | https://... |
| R | 来源链接 | ❌ | URL | https://... |

---

## 🚀 使用步骤

### 步骤1：打开文件

双击 `活动录入表格-改进版.xlsx` 文件

### 步骤2：查看首页（活动汇总）

- 首先看到蓝色的"活动汇总"页面
- 阅读说明，了解两种活动类型
- 准备好后，点击底部的工作表标签

### 步骤3：选择活动类型

#### 录入固定频率活动（每周重复课程）

1. 点击底部工作表标签：**固定频率活动**
2. 看到绿色表头
3. 填写 F列"星期"：例如 `周一,周三,周五`
4. 填写 G列"时间"：例如 `09:00-10:30`
5. 留空具体日期字段（本表中没有此列）

**适用场景**：
- ✅ 每周瑜伽课
- ✅ 定期冥想课程
- ✅ 例行文化活动
- ✅ 重复进行的健身班

#### 录入临时活动（一次性活动）

1. 点击底部工作表标签：**临时活动**
2. 看到黄色表头
3. 填写 F列"具体日期"：例如 `2025-02-01`
4. 填写 G列"时间"：例如 `14:00-17:00`
5. 留空星期字段（本表中没有此列）

**适用场景**：
- ✅ 单次工作坊
- ✅ 特别节庆活动
- ✅ 临时组织活动
- ✅ 一次性讲座

### 步骤4：填写数据

#### 使用下拉选择

点击以下字段的单元格，会自动显示下拉箭头：
- **分类**（C列）：瑜伽、冥想、户外探险、文化艺术、美食体验、节庆活动、其他
- **状态**（D列）：草稿、待开始、进行中、已过期
- **灵活时间**（O列）：是、否
- **需要预约**（P列）：是、否

#### 输入多个星期

在固定频率活动表的 F列：
- 输入：`周一,周三,周五`
- 输入：`周二,周四`
- 输入：`周六,周日`

⚠️ **注意**：
- 使用中文星期
- 用逗号分隔
- 不要使用数字（1、2、3）

#### 输入多个图片URL

在Q列单元格中：
1. 输入第一个URL
2. 按 `Alt+Enter` (Windows) 或 `Option+Command+Enter` (Mac) 换行
3. 输入第二个URL
4. 重复以上步骤

---

## 💡 填写示例

### 示例1：固定频率活动

```
活动标题: 流瑜伽基础班
分类: 瑜伽（下拉选择）
状态: 待开始（下拉选择）
活动描述: 适合初学者的流瑜伽课程，帮助提升柔韧性和力量
星期: 周一,周三,周五
时间: 09:00-10:30
持续时间: 1.5小时
地点名称: 宁曼一号瑜伽馆
详细地址: 清迈宁曼路1号
价格显示: 免费
最低价格: 0
最高价格: 0
最大人数: 15
灵活时间: 否（下拉选择）
需要预约: 是（下拉选择）
图片URL: https://images.unsplash.com/photo-1545205597-3d9d02c29597?w=400
```

### 示例2：临时活动

```
活动标题: 泰式烹饪工作坊
分类: 美食体验（下拉选择）
状态: 草稿（下拉选择）
活动描述: 学习制作冬阴功汤和泰式炒河粉，体验泰式烹饪文化
具体日期: 2025-02-01
时间: 14:00-17:00
持续时间: 3小时
地点名称: 清迈烹饪学校
详细地址: 老城中心Ratchadamnoen路
价格显示: 500฿
最低价格: 500
最高价格: 500
最大人数: 10
灵活时间: 否（下拉选择）
需要预约: 是（下拉选择）
图片URL: https://images.unsplash.com/photo-1556910103-1c02745aae4d?w=400
```

---

## ⚠️ 注意事项

### 1. 日期格式

✅ **正确格式**：`2025-02-01`（YYYY-MM-DD）
❌ **错误格式**：
- `02/01/2025`
- `2025年2月1日`
- `2025.02.01`

### 2. 星期格式

✅ **正确格式**：
- `周一`
- `周一,周三,周五`
- `周二,周四,周六`

❌ **错误格式**：
- `1,3,5`（数字）
- `Mon,Wed,Fri`（英文）
- `星期一,星期三`（多了"星期"二字）

### 3. 时间格式

✅ **推荐格式**：
- `09:00-10:30`
- `14:00-17:00`
- `19:00-21:00`

❌ **避免格式**：
- `9:00-10:30`（缺少前导零）
- `上午9点-10点半`（中文描述）

### 4. 价格字段

- **价格显示**（K列）：可以自由输入，例如 `免费`、`500฿`、`¥200`
- **最低价格**（L列）：必须是纯数字，例如 `0`、`500`
- **最高价格**（M列）：必须是纯数字，例如 `0`、`500`

### 5. 必填字段

以下字段不能为空：
- ✅ 活动标题（B列）
- ✅ 分类（C列）
- ✅ 活动描述（E列）
- ✅ 地点名称（I列）
- ✅ 星期或具体日期（F列，根据活动类型）

---

## 📤 数据导出和使用

### 导出到后台系统

**方式1：手动录入**
1. 打开 `http://localhost:3000/admin.html`
2. 点击"新增活动"
3. 根据活动类型选择 Tab
4. 按照Excel表格中的数据逐条录入

**方式2：复制粘贴**
1. 在Excel中复制一行数据
2. 在后台表单中逐个字段粘贴

### 保存为CSV格式

1. 切换到要导出的工作表
2. `文件` → `另存为`
3. 选择文件类型：`CSV UTF-8（逗号分隔）(*.csv)`
4. 保存文件

---

## 🎨 颜色标识

| 颜色 | 用途 | 说明 |
|------|------|------|
| 🔵 蓝色 | 活动汇总页 | 首页导航 |
| 🟢 绿色 | 固定频率活动表 | 每周重复课程 |
| 🟡 黄色 | 临时活动表 | 一次性活动 |
| ⬜ 浅绿 | 固定频率示例数据 | 参考示例 |
| ⬜ 浅黄 | 临时活动示例数据 | 参考示例 |

---

## 🔧 Excel技巧

### 快速切换工作表

- **方法1**：点击底部的工作表标签
- **方法2**：`Ctrl+PageUp/PageDown` (Windows) 或 `Cmd+Option+←/→` (Mac)

### 自动填充序号

1. 在 A5单元格输入：`1`
2. 在 A6单元格输入：`2`
3. 选中 A5:A6
4. 拖动右下角填充柄向下

### 批量复制相同值

1. 选中已填写的单元格
2. `Ctrl+C` 复制
3. 选中目标区域
4. `Ctrl+V` 粘贴

### 冻结表头

- 表头已自动冻结
- 滚动时表头始终可见
- 方便查看列名

---

## 📞 常见问题

### Q1: 如何判断使用哪个工作表？

**A**:
- 如果活动**每周重复**进行（如瑜伽课），使用"固定频率活动"表
- 如果活动**只进行一次**（如工作坊），使用"临时活动"表

### Q2: 可以同时填写两个工作表吗？

**A**:
- 可以，但同一个活动只能在一个表中录入
- 不要将同一个活动同时录入两个表

### Q3: 下拉选择不工作怎么办？

**A**:
- 确保启用了Excel的宏
- 检查文件是否只读
- 尝试重新下载文件

### Q4: 如何添加更多行？

**A**:
- 目表单已经包含998行空白数据行
- 如需更多，可以复制最后一行并粘贴

---

## 📁 文件管理

### 建议命名规范

- `活动数据-2025-01-25.xlsx`
- `瑜伽课程-固定频率.xlsx`
- `节庆活动-临时活动.xlsx`

### 备份建议

- 每次录入后及时保存
- 定期备份文件
- 重要数据建议云存储

---

**最后更新**：2025-01-25
**版本**：2.0（改进版）
**技术支持**：openpyxl 3.1.5
